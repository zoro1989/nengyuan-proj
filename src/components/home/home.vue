<template>
  <scroll class="home-container">
    <div class="home">
      <div class="panels row">
        <div class="panel-l col-md-6 col-xs-12">
          <div class="title xiazuan">
            能源指标
          </div>
          <div class="panel row">
            <div class="col-md-6 col-xs-12">
              <div class="panel-item">
                <div class="row">
                  <span class="row-item"><span class="big">0.0321</span>&nbsp;&nbsp;吨标煤/万元</span>
                </div>
                <div class="row">
                  <span class="row-item">同比<span class="down">&nbsp;<i class="fa fa-long-arrow-down"></i>&nbsp;532.94%</span></span>
                  <span class="row-item">&nbsp;环比<span class="down">&nbsp;<i class="fa fa-long-arrow-down"></i>&nbsp;23.94%</span></span>
                </div>
              </div>
            </div>
            <div class="col-md-6 col-xs-12">
              <div class="panel-item">
                <div class="row">
                  <span class="row-item"><span class="big">1665</span>&nbsp;&nbsp;元/辆</span>
                </div>
                <div class="row">
                  <span class="row-item">同比<span class="down">&nbsp;<i class="fa fa-long-arrow-down"></i>&nbsp;58.94%</span></span>
                  <span class="row-item">&nbsp;环比<span class="up">&nbsp;<i class="fa fa-long-arrow-up"></i>&nbsp;2.96%</span></span>
                </div>
              </div>
            </div>
          </div>
          <div class="panel row">
            <div class="col-md-6 col-xs-12">
              <div class="panel-item">
                <div class="row">
                  <span class="row-item"><span class="big">101.16</span>&nbsp;&nbsp;KGCO2/万元</span>
                </div>
                <div class="row">
                  <span class="row-item">同比<span class="down">&nbsp;<i class="fa fa-long-arrow-down"></i>&nbsp;7.94%</span></span>
                  <span class="row-item">&nbsp;环比<span class="down">&nbsp;<i class="fa fa-long-arrow-down"></i>&nbsp;58.94%</span></span>
                </div>
              </div>
            </div>
            <div class="col-md-6 col-xs-12">
              <div class="panel-item">
                <div class="row">
                  <span class="row-item"><span class="big">101.58</span>&nbsp;&nbsp;KGCO2/万元</span>
                </div>
                <div class="row">
                  <span class="row-item">同比<span class="up">&nbsp;<i class="fa fa-long-arrow-up"></i>&nbsp;2.54%</span></span>
                  <span class="row-item">&nbsp;环比<span class="up">&nbsp;<i class="fa fa-long-arrow-up"></i>&nbsp;2.96%</span></span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="panel-r col-md-6 col-xs-12">
          <div class="panel row">
            <div class="col-md-4  col-xs-12">
              <div class="panel-item">
                <div class="row xiazuan">能源用量</div>
                <div class="row">
                  <span class="row-item"><span class="big2">10.354</span>&nbsp;&nbsp;万吨/标煤</span>
                </div>
                <div class="row">
                  <div class="row-item">同比<span class="down">&nbsp;<i class="fa fa-long-arrow-down"></i>&nbsp;20.28%</span></div>
                </div>
                <div class="row">
                  <div class="row-item">环比<span class="up">&nbsp;<i class="fa fa-long-arrow-up"></i>&nbsp;2.73%</span></div>
                </div>
              </div>
            </div>
            <div class="col-md-4  col-xs-12">
              <div class="panel-item">
                <div class="row xiazuan">能源费用</div>
                <div class="row">
                  <span class="row-item"><span class="big2">37434.71</span>&nbsp;&nbsp;万元</span>
                </div>
                <div class="row">
                  <div class="row-item">同比<span class="down">&nbsp;<i class="fa fa-long-arrow-down"></i>&nbsp;17.68%</span></div>
                </div>
                <div class="row">
                  <div class="row-item">环比<span class="up">&nbsp;<i class="fa fa-long-arrow-up"></i>&nbsp;1.32%</span></div>
                </div>
              </div>
            </div>
            <div class="col-md-4  col-xs-12">
              <div class="panel-item">
                <div class="row xiazuan">生产产量</div>
                <div class="row">
                  <span class="row-item"><span class="big2">22.9788</span>&nbsp;&nbsp;万辆</span>
                </div>
                <div class="row">
                  <div class="row-item">同比<span class="down">&nbsp;<i class="fa fa-long-arrow-down"></i>&nbsp;212.2%</span></div>
                </div>
                <div class="row">
                  <div class="row-item">环比<span class="down">&nbsp;<i class="fa fa-long-arrow-down"></i>&nbsp;2.48%</span></div>
                </div>
              </div>
            </div>
          </div>
          <div class="panel row">
            <div class="col-md-6 col-xs-12">
              <div class="panel-item">
                <div class="row">碳排放量</div>
                <div class="row">
                  <span class="row-item"><span class="big">33.30</span>&nbsp;&nbsp;吨CO2排放量</span>
                </div>
                <div class="row">
                  <span class="row-item">同比<span class="down">&nbsp;<i class="fa fa-long-arrow-down"></i>&nbsp;56.2%</span></span>
                  <span class="row-item">&nbsp;环比<span class="up">&nbsp;<i class="fa fa-long-arrow-up"></i>&nbsp;34.7%</span></span>
                </div>
              </div>
            </div>
            <div class="col-md-6 col-xs-12">
              <div class="panel-item">
                <div class="row">绿色能源</div>
                <div class="row">
                  <span class="row-item"><span class="big">4586</span>&nbsp;&nbsp;吨标煤</span>
                </div>
                <div class="row">
                  <span class="row-item">同比<span class="down">&nbsp;<i class="fa fa-long-arrow-down"></i>&nbsp;12.2%</span></span>
                  <span class="row-item">&nbsp;环比<span class="up">&nbsp;<i class="fa fa-long-arrow-up"></i>&nbsp;6.7%</span></span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="real-time row">
        <div class="col-md-6 col-xs-12">
          <div class="dosage" ref="dosage"></div>
        </div>
        <div class="col-md-6 col-xs-12">
          <div class="cost" ref="cost"></div>
        </div>
      </div>
      <div class="chart row">
        <div class="col-md-8 col-xs-12">
          <div class="energy" ref="energy"></div>
        </div>
        <div class="col-md-4 col-xs-12">
          <div class="analyze" ref="analyze"></div>
        </div>
      </div>
    </div>
  </scroll>
</template>
<script>
import echarts from 'echarts'
import Scroll from 'base/scroll/scroll'
export default {
  components: {
    Scroll
  },
  methods: {
    makeEnergyChart() {
      // 基于准备好的dom，初始化echarts实例
      const myChart = echarts.init(this.$refs.energy)

      // 指定图表的配置项和数据
      const option = {
        title: {
          text: '能源用量与节能指标同比分析',
          x: 'center',
          textStyle: {
            color: '#ffffff'
          }
        },
        color: ['#5faee3', '#fdb944', '#ee672d', '#144ba6', '#b47913', '#eb0709'],
        tooltip: {
          trigger: 'axis',
          axisPointer: {
            type: 'cross',
            crossStyle: {
              color: '#283b56'
            },
            label: {
              backgroundColor: '#283b56'
            }
          }
        },
        legend: {
          padding: [5, 0, 0, 0],
          bottom: 0,
          data: ['实际能源用量', '计划能源用量', '上年同期能源用量', '计划节能指标', '实际节能指标', '上年同期节能指标'],
          textStyle: {
            color: '#ffffff'
          }
        },
        xAxis: [
          {
            type: 'category',
            data: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],
            axisPointer: {
              type: 'shadow'
            },
            axisLine: {
              lineStyle: {
                color: '#eee'
              }
            }
          }
        ],
        yAxis: [
          {
            type: 'value',
            name: '万吨标煤',
            min: 0.0,
            max: 50.0,
            interval: 10.0,
            // axisLabel: {
            // formatter: '{value} 吨'
            // },
            axisLine: {
              lineStyle: {
                color: '#eee'
              }
            }
          },
          {
            type: 'value',
            name: '吨标煤/万元',
            min: 0.00,
            max: 0.05,
            interval: 0.01,
            // axisLabel: {
            // formatter: '{value} 万元'
            // },
            axisLine: {
              lineStyle: {
                color: '#eee'
              }
            }
          }
        ],
        series: [
          {
            name: '实际能源用量',
            type: 'bar',
            data: [19.0, 31.0, 19.0, 29.0, 25.0, 31.0, 20.0, 17.0, 35.0, 31.0, 111135.0, 29.0],
            itemStyle: {
              barBorderRadius: [3, 3, 0, 0]
            }
          },
          {
            name: '计划能源用量',
            type: 'bar',
            data: [28.0, 21.0, 28.0, 28.0, 28.0, 16.0, 28.0, 22.0, 28.0, 21.0, 28.0, 28.0],
            itemStyle: {
              barBorderRadius: [3, 3, 0, 0]
            }
          },
          {
            name: '上年同期能源用量',
            type: 'bar',
            data: [20.0, 25.0, 22.0, 21.0, 25.0, 27.0, 29.0, 27.0, 20.0, 25.0, 22.0, 21.0],
            itemStyle: {
              barBorderRadius: [3, 3, 0, 0]
            }
          },
          {
            name: '计划节能指标',
            type: 'line',
            yAxisIndex: 1,
            data: [0.005, 0.012, 0.01, 0.012, 0.013, 0.018, 0.016, 0.012, 0.005, 0.012, 0.01, 0.012]
          },
          {
            name: '实际节能指标',
            type: 'line',
            yAxisIndex: 1,
            data: [0.007, 0.009, 0.015, 0.005, 0.007, 0.012, 0.013, 0.019, 0.007, 0.009, 0.015, 0.005]
          },
          {
            name: '上年同期节能指标',
            type: 'line',
            yAxisIndex: 1,
            data: [0.012, 0.013, 0.017, 0.016, 0.018, 0.017, 0.016, 0.015, 0.012, 0.013, 0.017, 0.016]
          }

        ]
      }

      // 使用刚指定的配置项和数据显示图表。
      myChart.setOption(option)
    },
    makeAnalyzeChart() {
      const myChart = echarts.init(this.$refs.analyze)

      // 指定图表的配置项和数据
      const option = {
        color: ['#e9aefc', '#3572f0', '#5faee3', '#fdb944', '#ee672d', '#81f2bb'],
        title: {
          text: '分公司产量占总产量比重',
          x: 'center',
          textStyle: {
            color: '#ffffff'
          }
        },
        tooltip: {
          trigger: 'item',
          formatter: '{a} <br/>{b} : {c} ({d}%)'
        },
        series: [
          {
            name: '访问来源',
            type: 'pie',
            radius: '55%',
            center: ['50%', '60%'],
            data: [
              {value: 325, name: '水'},
              {value: 168, name: '其他'},
              {value: 168, name: '原煤'},
              {value: 325, name: '高温水'},
              {value: 325, name: '天然气'},
              {value: 325, name: '电'}
            ],
            itemStyle: {
              emphasis: {
                shadowBlur: 10,
                shadowOffsetX: 0,
                shadowColor: 'rgba(0, 0, 0, 0.5)'
              }
            }
          }
        ]
      }

      // 使用刚指定的配置项和数据显示图表。
      myChart.setOption(option)
    },
    makeDosageChart() {
      const myChart = echarts.init(this.$refs.dosage)

      // 指定图表的配置项和数据
      const option = {
        color: ['#5faee3'],
        title: {
          text: '实时能源用量',
          x: 'center',
          textStyle: {
            color: '#ffffff'
          }
        },
        tooltip: {
          trigger: 'axis',
          axisPointer: {
            type: 'cross',
            label: {
              backgroundColor: '#283b56'
            }
          }
        },
        dataZoom: {
          show: false,
          start: 0,
          end: 100
        },
        xAxis: [
          {
            type: 'category',
            boundaryGap: true,
            axisLine: {
              lineStyle: {
                color: '#eee'
              }
            },
            axisLabel: {
              interval: 1
            },
            data: (function () {
              var now = new Date()
              var res = []
              var len = 10
              while (len--) {
                res.unshift(now.toLocaleTimeString().replace(/^\D*/, ''))
                now = new Date(now - 2000)
              }
              return res
            })()
          }
        ],
        yAxis: [
          {
            type: 'value',
            scale: true,
            name: '吨原煤',
            max: 30,
            min: 0,
            boundaryGap: [0.2, 0.2],
            axisLine: {
              lineStyle: {
                color: '#eee'
              }
            }
          }
        ],
        series: [
          {
            name: '能耗',
            type: 'line',
            areaStyle: {},
            data: (function () {
              var res = []
              var len = 0
              while (len < 10) {
                res.push((Math.random() * 10 + 5).toFixed(1) - 0)
                len++
              }
              return res
            })()
          }
        ]
      }

      setInterval(function () {
        let axisData = (new Date()).toLocaleTimeString().replace(/^\D*/, '')

        var data0 = option.series[0].data
        data0.shift()
        data0.push((Math.random() * 10 + 5).toFixed(1) - 0)

        option.xAxis[0].data.shift()
        option.xAxis[0].data.push(axisData)

        myChart.setOption(option)
      }, 2100)

      // 使用刚指定的配置项和数据显示图表。
      myChart.setOption(option)
    },
    makeCostChart() {
      const myChart = echarts.init(this.$refs.cost)

      // 指定图表的配置项和数据
      const option = {
        color: ['#e9aefc', '#3572f0', '#5faee3', '#fdb944', '#ee672d', '#81f2bb'],
        title: {
          text: '实时能源费用',
          x: 'center',
          textStyle: {
            color: '#ffffff'
          }
        },
        tooltip: {
          trigger: 'axis',
          axisPointer: {
            type: 'cross',
            label: {
              backgroundColor: '#283b56'
            }
          }
        },
        dataZoom: {
          show: false,
          start: 0,
          end: 100
        },
        xAxis: {
          type: 'category',
          boundaryGap: true,
          axisLine: {
            lineStyle: {
              color: '#eee'
            }
          },
          axisLabel: {
            interval: 1
          },
          data: (function () {
            var now = new Date()
            var res = []
            var len = 10
            while (len--) {
              res.unshift(now.toLocaleTimeString().replace(/^\D*/, ''))
              now = new Date(now - 2000)
            }
            return res
          })()
        },
        yAxis: {
          type: 'value',
          scale: true,
          name: '元/万',
          max: 1200,
          min: 0,
          boundaryGap: [0.2, 0.2],
          axisLine: {
            lineStyle: {
              color: '#eee'
            }
          }
        },
        series: [
          {
            name: '费用',
            type: 'bar',
            itemStyle: {
              barBorderRadius: [3, 3, 0, 0]
            },
            data: (function () {
              var res = []
              var len = 10
              while (len--) {
                res.push(Math.round(Math.random() * 1000))
              }
              return res
            })()
          }
        ]
      }

      setInterval(function () {
        var axisData = (new Date()).toLocaleTimeString().replace(/^\D*/, '')
        var data0 = option.series[0].data
        data0.shift()
        data0.push(Math.round(Math.random() * 1000))

        option.xAxis.data.shift()
        option.xAxis.data.push(axisData)

        myChart.setOption(option)
      }, 2100)

      // 使用刚指定的配置项和数据显示图表。
      myChart.setOption(option)
    }
  },
  mounted() {
    this.makeEnergyChart()
    this.makeAnalyzeChart()
    this.makeDosageChart()
    this.makeCostChart()
  }
}
</script>
<style scoped lang="stylus">
  @import "~common/stylus/variable.styl"
  @import "~common/stylus/mixin.styl"
  .home-container
    overflow: hidden
    position: absolute
    top: 60px
    left: 0
    right: 0
    bottom: 0
    .home
      .panels
        .panel-l,.panel-r
          display: flex
          flex-direction: column
          .title
            text-align: center
            height: 50px
            line-height: 50px
            background: #354052
            margin: 5px
            cursor: pointer
            &.xiazuan:hover
              color: #fc3507
          .panel
            flex: 1
            .panel-item
              box-sizing: border-box
              cursor: pointer
              background: #354052
              margin: 5px
              color: #89c5fc
              padding: 5px
              box-sizing: border-box
              height: 100%
              display: flex
              flex-direction: column
              .row
                flex: 1
                display: flex
                align-items: center
                &.xiazuan:hover
                  color: #fc3507
                .row-item
                  min-height: 35px
                  display: flex
                  align-items: center
                  .big
                    font-size: $font-size-large-x-x
                  .big2
                    font-size: $font-size-large-x
                  .down
                    color: #08ae5e
                  .up
                    color: #ef3d14
              .subtitle
                color: #ffffff
      .real-time
        .dosage
          height: 200px
          display: flex
          background: #354052
          margin: 5px
          padding: 5px
          justify-content: flex-start
        .cost
          height: 200px
          display: flex
          background: #354052
          margin: 5px
          padding: 5px
          justify-content: flex-end
      .chart
        padding-bottom: 5px
        .energy
          height: 280px
          display: flex
          background: #354052
          margin: 5px
          padding: 5px
          justify-content: flex-start
        .analyze
          display: flex
          background: #354052
          margin: 5px
          padding: 5px
          justify-content: flex-start
          height: 280px
</style>
